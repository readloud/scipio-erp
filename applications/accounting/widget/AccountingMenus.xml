<?xml version="1.0" encoding="UTF-8"?>
<!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed 
    with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, 
    Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at 
    http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the 
    License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License 
    for the specific language governing permissions and limitations under the License. -->

<menus xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-menu.xsd">

    <menu name="AccountingAppBar" title="${uiLabelMap.AccountingAccounting}" extends="CommonAppBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <!-- Accounting -->
        <menu-item name="payable" title="${uiLabelMap.AccountingAccountsPayable}">
            <link target="apmain"/>
        </menu-item>
        <menu-item name="receivable" title="${uiLabelMap.AccountingAccountsReceivable}">
            <link target="armain"/>
        </menu-item>
        <!-- Payment Transactions
        <menu-item name="transaction" title="${uiLabelMap.AccountingTransactions}"> 
            <condition>
                <or>
                    <if-has-permission permission="MANUAL" action="_PAYMENT" />
                    <if-has-permission permission="ACCOUNTING" action="_CREATE" />
                </or>
            </condition>
            <link target="FindGatewayResponses" />
        </menu-item>-->
        <menu-item name="chartofaccounts" title="${uiLabelMap.AcctgChartOfAcctsTabMenu}">
            <link target="GlAccountNavigate" />
        </menu-item>
        <menu-item name="payments" title="${uiLabelMap.AccountingPaymentsMenu}">
            <link target="findPayments" />
        </menu-item>
        <menu-item name="ListFixedAssets" title="${uiLabelMap.AccountingFixedAssets}">
            <link target="ListFixedAssets" />
        </menu-item>
        <menu-item name="billingaccount" title="${uiLabelMap.AccountingBillingMenu}">
            <link target="FindBillingAccount" />
        </menu-item>
        <menu-item name="FinAccount" title="${uiLabelMap.AccountingFinAccount}">
            <link target="FinAccountMain" />
        </menu-item>
        <menu-item name="ListInvoices" title="${uiLabelMap.AccountingInvoices}">
            <link target="findInvoices" />
        </menu-item>
        
        <!-- Contracts -->
        <menu-item name="Contracts" title="${uiLabelMap.AccountingContracts}">
            <link target="FindAgreement"/>
        </menu-item>      
        
        <!-- Transactions -->
        <menu-item name="Transactions" title="${uiLabelMap.AccountingTransactions}">
            <link target="Transactions" />
        </menu-item>
        
        <!-- Reports -->
        <menu-item name="TransactionReports" title="${uiLabelMap.AccountingReports}">
            <link target="TransactionReports" />
        </menu-item>

        <!-- Controlling -->
        <menu-item name="controlling" title="${uiLabelMap.AccountingControlling}">
            <link target="ListBudgets"/>
        </menu-item>  
        
        <!-- Other -->
        <menu-item name="ImportExport" title="${uiLabelMap.CommonImportExport}">
            <link target="ExportTransactions" />
        </menu-item>
        <menu-item name="settings" title="${uiLabelMap.CommonSettings}">
            <link target="settings" />
        </menu-item>
    </menu>

    <menu name="AccountingAppSideBar" title="${uiLabelMap.AccountingManager}" extends="CommonAppSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-elements menu-name="AccountingAppBar" recursive="full" />
        <menu-item name="payable">
            <sub-menu name="AccountsPayable" include="AccountsPayableSidebar"/>
        </menu-item>
        <menu-item name="receivable">
            <sub-menu name="AccountsReceivable" include="AccountsReceivableSideBar"/>
        </menu-item>
        <menu-item name="billingaccount">
            <sub-menu name="BillingAccount" include="BillingAccountSidebar"/>
        </menu-item>
        <menu-item name="chartofaccounts">
            <sub-menu name="CommonGL" include="CommonGLSideBar"/>
        </menu-item>
        <menu-item name="Contracts">
            <sub-menu name="Contracts" include="ContractsSideBar"/>
        </menu-item>
        <menu-item name="controlling">
            <sub-menu name="Controlling" include="ControllingSideBar"/>
        </menu-item>
        <menu-item name="FinAccount">
            <sub-menu name="FinAccount" include="FinAccountSideBar"/>
        </menu-item>
        <menu-item name="ListFixedAssets">
            <sub-menu name="FixedAssets" include="FixedAssetsSideBar"/>
        </menu-item>
        <menu-item name="ListInvoices">
            <sub-menu name="Invoice" include="InvoiceSideBar"/>
        </menu-item>
        <menu-item name="ImportExport">
            <sub-menu name="ImportExport" include="ImportExportSideBar"/>
        </menu-item>
        <menu-item name="Transactions">
            <sub-menu name="Transactions" include="TransactionsSideBar"/>
        </menu-item>
        <menu-item name="TransactionReports">
            <sub-menu name="TransactionReports" include="TransactionReportsSideBar"/>
        </menu-item>
        <menu-item name="payments">
            <sub-menu name="Payment" include="PaymentSideBar"/>
        </menu-item>
        <menu-item name="settings">
            <sub-menu name="Settings" include="SettingsSideBar"/>
        </menu-item>
    </menu>
    
    
    
    
    <!-- 
    **************
    * Accounts Payable 
    **************
    -->
    <menu name="AccountsPayableSidebar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="apmain" title="${uiLabelMap.CommonOverview}" sort-mode="off"> 
            <condition><not><if-empty field="userLogin"/></not></condition>
            <link target="apmain" link-type="anchor"/>
        </menu-item>
        <menu-item name="findApInvoices" title="${uiLabelMap.AccountingInvoicesMenu}">
            <link target="FindApInvoices"/>
            <!-- <sub-menu name="Invoice" include="ApInvoiceSideBar"/>-->
        </menu-item>
        <menu-item name="findApPayments" title="${uiLabelMap.AccountingPaymentsMenu}">
            <link target="FindApPayments"/>
            <!-- <sub-menu name="APPayment" include="ApPaymentSideBar"/> -->
        </menu-item>
        <menu-item name="apPaymentGroups" title="${uiLabelMap.AccountingApPaymentGroupMenu}">
            <link target="FindApPaymentGroups"/>
            <sub-menu name="PaymentGroup" include="component://accounting/widget/AccountingMenus.xml#PaymentGroupSideBar"/>
        </menu-item>
        <!--
        <menu-item name="apfindVendors" title="${uiLabelMap.AccountingVendors}">
            <link target="findApVendors"/>
        </menu-item>-->
        <menu-item name="apReports" title="${uiLabelMap.AccountingReports}">
            <link target="listAPReports"/>
            <!-- <sub-menu name="ApReport" include="ApReportSideBar"/>-->
        </menu-item>
    </menu>
    
    <!-- 
    <menu name="ApInvoiceTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="viewInvoices">
        <include-elements menu-name="InvoiceTabBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
        <menu-item name="commissionRun" title="${uiLabelMap.AccountingCommissionRun}">
            <link target="CommissionRun"/>
        </menu-item>
    </menu>
    
    <menu name="ApInvoiceSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="viewInvoices">
        <include-elements menu-name="ApInvoiceTabBar" recursive="includes-only" />
        <include-elements menu-name="InvoiceSideBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
        <menu-item-alias name="viewInvoices" for="PARENT-WITHSUB"/>
        <menu-item-alias name="newInvoice" for="PARENT-WITHSUB"/>
    </menu>
    
    <menu name="ApReportTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="viewInvoices">
        <menu-item name="commissionReport" title="${uiLabelMap.AccountingCommissionReport}">
            <link target="FindCommissions"/>
        </menu-item>
    </menu>
    
    <menu name="ApPaymentSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-elements menu-name="ApPaymentTabBar" recursive="includes-only" />
        <include-elements menu-name="PaymentSideBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
        <menu-item-alias name="findApPayments" for="PARENT-NOSUB"/>
        <menu-item-alias name="newApPayment" for="PARENT-NOSUB"/>
    </menu> -->
    
    <!-- 
    **************
    * Accounts Receivable 
    **************
    -->
    <menu name="AccountsReceivableSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="armain" title="${uiLabelMap.CommonOverview}" sort-mode="off" override-mode="remove-replace"> 
            <condition><not><if-empty field="userLogin"/></not></condition>
            <link target="armain" link-type="anchor"/>
        </menu-item>
        <menu-item name="findArInvoices" title="${uiLabelMap.AccountingInvoicesMenu}">
            <link target="findArInvoices"/>
        </menu-item>
        <menu-item name="findArPayments" title="${uiLabelMap.AccountingPaymentsMenu}">
            <link target="findArPayments"/>
        </menu-item>
        <menu-item name="arPaymentGroups" title="${uiLabelMap.AccountingArPaymentGroupMenu}">
            <link target="FindArPaymentGroups"/>
            <sub-menu name="ArPaymentGroup" include="component://accounting/widget/AccountingMenus.xml#PaymentGroupSideBar"/>
        </menu-item>
        <menu-item name="arReports" title="${uiLabelMap.AccountingReports}">
            <link target="ListARReports"/>
        </menu-item>
    </menu>
    
    <!--
    <menu name="ArPaymentTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-elements menu-name="PaymentTabBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>        
        <menu-item name="findPayments" title="${uiLabelMap.PageTitleFindPayment}">
            <link target="findPayments"/>
        </menu-item>
        <menu-item name="batchPayments" title="${uiLabelMap.PageTitleBatchPayments}">
            <link target="batchPayments"/>
        </menu-item>
    </menu>
    
    <menu name="ArPaymentSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-elements menu-name="ArPaymentTabBar" recursive="includes-only" />
        <include-elements menu-name="PaymentSideBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
        <menu-item-alias name="newPayment" for="PARENT-WITHSUB"/>
    </menu>
    
    <menu name="ArInvoiceTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="viewInvoices">
        <include-elements menu-name="InvoiceTabBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
    </menu>
    
    <menu name="ArInvoiceSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="viewInvoices">
        <include-elements menu-name="ArInvoiceTabBar" recursive="includes-only" />
        <include-elements menu-name="InvoiceSideBar" resource="component://accounting/widget/AccountingMenus.xml" recursive="includes-only"/>
    </menu>
    -->
    
    <!-- 
    **************
    * Billing Accounts
    **************
     -->
    <menu name="BillingAccountSidebar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
    </menu>
     
    <menu name="BillingAccountTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="FindBillingAccount" title="${uiLabelMap.CommonFind}">
            <link target="FindBillingAccount" />
        </menu-item>
        <menu-item name="EditBillingAccount" title="${uiLabelMap.CommonAccount}">
            <link target="EditBillingAccount">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
        <menu-item name="EditBillingAccountRoles" title="${uiLabelMap.CommonRoles}">
            <link target="EditBillingAccountRoles">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
        <menu-item name="EditBillingAccountTerms" title="${uiLabelMap.CommonTerms}">
            <link target="EditBillingAccountTerms">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
        <menu-item name="BillingAccountInvoices" title="${uiLabelMap.CommonInvoices}">
            <link target="BillingAccountInvoices">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
        <menu-item name="BillingAccountPayments" title="${uiLabelMap.CommonPayments}">
            <link target="BillingAccountPayments">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
        <menu-item name="BillingAccountOrders" title="${uiLabelMap.CommonOrders}">
            <link target="BillingAccountOrders">
                <parameter param-name="billingAccountId" from-field="billingAccount.billingAccountId" />
            </link>
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Chart of accounts
    **************
     -->
    <menu name="CommonGLSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="GlAccountNavigate">
        <actions>
            <!-- SCIPIO: DEV NOTE: This must NOT be set global or it may get shadowed by a null in the MapStack: global="true";
                global is usually not appropriate for menu actions -->
            <set field="organizationPartyId" from-field="parameters.organizationPartyId" default-value="${defaultOrganizationPartyId}"/>
        </actions>
        <menu-item name="Chartofaccounts" title="${uiLabelMap.AccountingChartOfAcctsMenu}">
            <link target="FindGlobalGlAccount" />
        </menu-item>
        <menu-item name="GlAccountNavigate" title="${uiLabelMap.AcctgNavigateAccts}">
            <link target="GlAccountNavigate" />
        </menu-item>
        <menu-item name="FindAcctgTrans" title="${uiLabelMap.AccountingAcctgTrans}">
            <link target="FindAcctgTrans">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
    </menu>

    <menu name="GlAccountTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="FindGlobalGlAccount" title="${uiLabelMap.AcctgChartOfAcctsTabMenu}">
            <link target="FindGlobalGlAccount" />
        </menu-item>
        <menu-item name="AssignGlAccount" title="${uiLabelMap.AcctgAssignGlAccount}">
            <link target="AssignGlAccount" />
        </menu-item>
    </menu>

    <menu name="GlSettingTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        selected-menuitem-context-field-name="activeSubMenuItem2">
        <menu-item name="GlAccountNavigate" title="${uiLabelMap.AcctgNavigateAccts}">
            <link target="GlAccountNavigate">
                <parameter param-name="trail" value="null" />
            </link>
        </menu-item>
        <menu-item name="AssignGlAccount" title="${uiLabelMap.AcctgAssignGlAccount}">
            <link target="AssignGlAccount" />
        </menu-item>
    </menu>

    <menu name="GlAccountCategoryTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        selected-menuitem-context-field-name="activeSubMenuItem2">
        <menu-item name="EditGlAccountCategory" title="${uiLabelMap.FormFieldTitle_glAccountCategory}">
            <link target="EditGlAccountCategory">
                <parameter param-name="glAccountCategoryId" />
                <parameter param-name="glAccountCategoryTypeId" />
            </link>
        </menu-item>
        <menu-item name="EditGlAccountCategoryMember" title="${uiLabelMap.FormFieldTitle_glAccountCategoryMember}">
            <link target="EditGlAccountCategoryMember">
                <parameter param-name="glAccountCategoryId" />
            </link>
        </menu-item>
    </menu>
    
    <!-- SCIPIO: new, replaces manual links -->
    <menu name="GlAccountListSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="ListGlAccountsReport" title="${uiLabelMap.CommonPrint}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <link target="ListGlAccountsReport"/>
        </menu-item>
        <menu-item name="ListGlAccountsExport" title="${uiLabelMap.CommonExport}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <link target="ListGlAccountsExport"/>
        </menu-item>
    </menu>
    
    <!-- SCIPIO: new, combined bar -->
    <menu name="GlAccountListCombinedTabBar" items-sort-mode="off" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-menu-items menu-name="GlSettingTabBar" recursive="full"/>
        <include-menu-items menu-name="GlAccountListSubTabBar" recursive="full"/>
    </menu>
    
    <!--
    ************** 
    * Contracts 
    **************
    -->
    <!--SCIPIO: Agreement fixes -->
    <menu name="ContractsSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditAgreement" menu-container-style="+scipio-nav-actions-menu">
        <menu-item name="EditAgreement" title="${uiLabelMap.AccountingAgreement}">
            <link target="EditAgreement">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="AgreementItems" title="${uiLabelMap.CommonItems}">
            <link target="ListAgreementItems">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
            <sub-menu include="AgreementItemSideBar" name="AgreementItem"/>
        </menu-item>
        <menu-item name="AgreementRoles" title="${uiLabelMap.CommonParties}">
            <link target="EditAgreementRoles">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="AgreementTerms" title="${uiLabelMap.AccountingAgreementTerms}">
            <link target="EditAgreementTerms">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="AgreementWorkEffort" title="${uiLabelMap.WorkEffort}">
            <link target="EditAgreementWorkEffortApplics">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
    </menu>

    <menu name="AgreementTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditAgreementItem" menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="EditAgreementItem" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonItem}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditAgreementItem">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="NewRole" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonParty}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <if-empty field="agreementItem.agreementItemSeqId"/>
            </condition>
            <link target="EditAgreementRoles">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="NewTerm" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonTerm}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <if-empty field="agreementItem.agreementItemSeqId"/>
            </condition>
            <link target="EditAgreementTerms">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="NewWorkEffort" title="${uiLabelMap.CommonNew} ${uiLabelMap.WorkEffort}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <if-empty field="agreementItem.agreementItemSeqId"/>
            </condition>
            <link target="EditAgreementWorkEffortApplics">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="NewGeo" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonGeo}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementGeographicalApplic">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewFacility" title="${uiLabelMap.ProductNewFacility}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemFacility">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewParty" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonParty}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemParty">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewProduct" title="${uiLabelMap.ProductNewProduct}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemProduct">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewPromo" title="${uiLabelMap.AccountingNewAgreementPromoAppl}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementPromoAppl">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewItemTerm" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonTerm}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemTerm">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
    </menu>

    <menu name="AgreementItemTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
          default-menu-item-name="EditAgreementItem">
        <menu-item name="EditAgreementItem" title="${uiLabelMap.AccountingAgreementItem}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItem">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementGeographicalApplic" title="${uiLabelMap.CommonGeo}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementGeographicalApplic">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementItemWarehouses" title="${uiLabelMap.ProductFacilities}">
            <condition>
                <and>
                    <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
                    <if-compare field="agreement.agreementTypeId" operator="not-equals" value="PURCHASE_AGREEMENT" />
                </and>
            </condition>
            <link target="ListAgreementItemFacilities">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementItemParties" title="${uiLabelMap.PartyParties}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementItemParties">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementItemProducts" title="${uiLabelMap.ProductProducts}">
            <condition>
                <and>
                    <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
                    <if-compare field="agreement.agreementTypeId" operator="not-equals" value="PURCHASE_AGREEMENT" />
                </and>
            </condition>
            <link target="ListAgreementItemProducts">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementPromoAppls" title="${uiLabelMap.AccountingAgreementPromoAppls}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementPromoAppls">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementItemSupplierProducts" title="${uiLabelMap.ProductProducts}">
            <condition>
                <and>
                    <if-compare field="agreement.agreementTypeId" operator="equals" value="PURCHASE_AGREEMENT" />
                    <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
                </and>
            </condition>
            <link target="ListAgreementItemSupplierProducts">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ListAgreementItemTerms" title="${uiLabelMap.AccountingAgreementItemTerms}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementItemTerms">
                <parameter param-name="agreementId" from-field="agreementItem.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="FacilitiesReport" title="${uiLabelMap.Facilities}: ${uiLabelMap.CommonPdf}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementItemFacilitiesReport" target-window="_blank">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="ProductsReport" title="${uiLabelMap.Products}: ${uiLabelMap.CommonPdf}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="ListAgreementItemProductsReport" target-window="_blank">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
    </menu>

    <menu name="AgreementItemSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditAgreementItem" menu-container-style="+scipio-nav-actions-menu">
        <include-elements menu-name="AgreementItemTabBar" recursive="includes-only" />
    </menu>

    <menu name="AgreementItemSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="NewItem" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonItem}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditAgreementItem">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
            </link>
        </menu-item>
        <menu-item name="NewGeo" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonGeo}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementGeographicalApplic">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewFacility" title="${uiLabelMap.ProductNewFacility}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemFacility">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewParty" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonParty}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemParty">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewProduct" title="${uiLabelMap.ProductNewProduct}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemProduct">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewPromo" title="${uiLabelMap.AccountingNewAgreementPromoAppl}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementPromoAppl">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
        <menu-item name="NewTerm" title="${uiLabelMap.AccountingNewAgreementItemTerm}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="agreementItem.agreementItemSeqId"/></not>
            </condition>
            <link target="EditAgreementItemTerm">
                <parameter param-name="agreementId" from-field="agreement.agreementId" />
                <parameter param-name="agreementItemSeqId" from-field="agreementItem.agreementItemSeqId" />
            </link>
        </menu-item>
    </menu>

    <!-- 
    **************
    * Controlling 
    **************
    -->
    <menu name="ControllingSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="ListBudgets" title="${uiLabelMap.AccountingBudgets}">
            <link target="ListBudgets" />
        </menu-item>
        <menu-item name="CostCenters" title="${uiLabelMap.FormFieldTitle_costCenters}">
            <link target="CostCenters" />
        </menu-item>
    </menu>
    
    
    <menu name="BudgetTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="ListBudgets" title="${uiLabelMap.AccountingBudgetFind}">
            <link target="ListBudgets" />
        </menu-item>
        <menu-item name="EditBudget" title="${uiLabelMap.AccountingBudget}">
            <link target="EditBudget">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
        <menu-item name="BudgetOverview" title="${uiLabelMap.AccountingBudgetOverview}">
            <link target="BudgetOverview">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
        <menu-item name="BudgetItem" title="${uiLabelMap.CommonItems}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <or>
                        <if-compare field="statusId" operator="equals" value="BG_CREATED" />
                        <if-compare field="statusId" operator="equals" value="BG_REVIEWED" />
                    </or>
                </and>
            </condition>
            <link target="EditBudgetItems">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
        <menu-item name="BudgetRoles" title="${uiLabelMap.CommonParties}">
            <link target="BudgetRoles">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
        <menu-item name="BudgetReviews" title="${uiLabelMap.AccountingBudgetReviews}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <if-compare field="statusId" operator="not-equals" value="BG_REJECTED" />
                </and>
            </condition>
            <link target="BudgetReviews">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
    </menu>

    <menu name="BudgetSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="EditBudget" title="${uiLabelMap.CommonEdit}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <or>
                        <if-compare field="statusId" operator="equals" value="BG_CREATED" />
                        <if-compare field="statusId" operator="equals" value="BG_REVIEWED" />
                    </or>
                </and>
            </condition>
            <link target="EditBudget">
                <parameter param-name="budgetId" />
            </link>
        </menu-item>
        <menu-item name="statusToApproved" title="${uiLabelMap.AccountingBudgetStatusToApproved}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <or>
                        <if-compare field="statusId" operator="equals" value="BG_CREATED" />
                        <if-compare field="statusId" operator="equals" value="BG_REVIEWED" />
                    </or>
                </and>
            </condition>
            <link target="updateBudgetStatus">
                <parameter param-name="budgetId" from-field="budgetId" />
                <parameter param-name="statusId" value="BG_APPROVED" />
            </link>
        </menu-item>
        <menu-item name="statusToReview" title="${uiLabelMap.AccountingBudgetStatusToReviewed}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <if-compare field="statusId" operator="equals" value="BG_CREATED" />
                </and>
            </condition>
            <link target="updateBudgetStatus">
                <parameter param-name="budgetId" from-field="budgetId" />
                <parameter param-name="statusId" value="BG_REVIEWED" />
            </link>
        </menu-item>
        <menu-item name="statusToReject" title="${uiLabelMap.AccountingBudgetStatusToRejected}">
            <condition>
                <and>
                    <not>
                        <if-empty field="budgetId" />
                    </not>
                    <or>
                        <if-compare field="statusId" operator="equals" value="BG_CREATED" />
                        <if-compare field="statusId" operator="equals" value="BG_REVIEWED" />
                        <if-compare field="statusId" operator="equals" value="BG_APPROVED" />
                    </or>
                </and>
            </condition>
            <link target="updateBudgetStatus">
                <parameter param-name="budgetId" from-field="budgetId" />
                <parameter param-name="statusId" value="BG_REJECTED" />
            </link>
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Finance
    **************
     -->
   <menu name="FinAccountTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditFinAccount">
        <menu-item name="EditFinAccount" title="${uiLabelMap.AccountingFinAccount}">
            <link target="EditFinAccount">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
        <menu-item name="EditFinAccountRoles" title="${uiLabelMap.CommonParties}">
            <link target="EditFinAccountRoles">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
        <menu-item name="FinAccountTrans" title="${uiLabelMap.AccountingFinAccountTransations}">
            <link target="FindFinAccountTrans">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
        <menu-item name="EditFinAccountAuths" title="${uiLabelMap.AccountingFinAccountAuth}">
            <condition>
                <if-compare field="finAccount.finAccountTypeId" operator="not-equals" value="BANK_ACCOUNT" />
            </condition>
            <link target="EditFinAccountAuths">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
        <menu-item name="depositWithdraw" title="${uiLabelMap.AccountingDepositWithdraw}">
            <link target="FindPaymentsForDepositOrWithdraw">
                <parameter param-name="finAccountId" />
                <parameter param-name="organizationPartyId" from-field="finAccount.ownerPartyId" />
            </link>
        </menu-item>
        <menu-item name="findDepositSlips" title="${uiLabelMap.AccountingDepositSlips}">
            <link target="FindDepositSlips">
                <parameter param-name="finAccountId" />
                <parameter param-name="organizationPartyId" from-field="finAccount.ownerPartyId" />
            </link>
        </menu-item>
        <menu-item name="FindFinAccountReconciliations" title="${uiLabelMap.AccountingReconciliation}">
            <link target="FindFinAccountReconciliations">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
    </menu>

    <menu name="FinAccountSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditFinAccount" menu-container-style="+scipio-nav-actions-menu">
        <include-elements menu-name="FinAccountTabBar" recursive="includes-only" />
    </menu>

    <menu name="FinAccountSubTabBar" menu-container-style="+${styles.menu_buttonstyle_alt2}" extends="CommonSubTabBarMenu"
        extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="createNew" title="${uiLabelMap.CommonNew} ${uiLabelMap.AccountingFinAccount}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditFinAccount" />
        </menu-item>
        <menu-item name="advancedFinAccountSearch" title="${uiLabelMap.CommonAdvancedSearch}">
            <condition>
                <if-compare field="displayAdvancedSearch" operator="not-equals" value="true" />
            </condition>
            <link target="FindFinAccount">
                <parameter param-name="displayAdvancedSearch" value="true" />
            </link>
        </menu-item>
        <menu-item name="quickFinAccountSearch" title="${uiLabelMap.AccountingQuickSearch}">
            <condition>
                <if-compare field="displayAdvancedSearch" operator="equals" value="true" />
            </condition>
            <link target="FindFinAccount" />
        </menu-item>
    </menu>

    <menu name="FinAccountMainTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="finAccountMain" title="${uiLabelMap.CommonMain}">
            <link target="FinAccountMain" />
        </menu-item>
        <menu-item name="FindFinAccount" title="${uiLabelMap.PageTitleFindFinAccount}">
            <link target="FindFinAccount" />
        </menu-item>
    </menu>

    <menu name="FinAccountMainSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <include-elements menu-name="FinAccountSideBar" recursive="includes-only" />
    </menu>

    <menu name="FinAccountReconciliationsTabBar" extends="CommonButtonBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="Find" title="${uiLabelMap.AccountingFindFinAccountReconciliations}">
            <condition>
                <and>
                    <not>
                        <if-empty field="finAccountId" />
                    </not>
                    <not>
                        <if-empty field="glReconciliationId" />
                    </not>
                    <if-compare field="activeSubMenuItem2" operator="not-equals" value="Find" />
                </and>
            </condition>
            <link target="FindFinAccountReconciliations">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
        <menu-item name="NewFinAccountReconciliations" title="${uiLabelMap.CommonNew}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <and>
                    <and>
                        <if-compare field="finAccount.statusId" operator="not-equals" value="FNACT_MANFROZEN" />
                        <if-compare field="finAccount.statusId" operator="not-equals" value="FNACT_CANCELLED" />
                    </and>
                    <or>
                        <not>
                            <if-empty field="glReconciliationId" />
                        </not>
                        <if-compare field="activeSubMenuItem2" operator="equals" value="Find" />
                    </or>
                </and>
            </condition>
            <link target="EditFinAccountReconciliations">
                <parameter param-name="finAccountId" />
            </link>
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Fixed Assets
    **************
    -->
    
    <menu name="FixedAssetsSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="ListFixedAssets" menu-container-style="+scipio-nav-actions-menu">
        <!-- Disabled for as long as there is only one entry
        <menu-item name="ListFixedAssets" title="${uiLabelMap.AccountingFixedAssets}">
            <link target="ListFixedAssets" />
        </menu-item>-->
        <include-elements menu-name="FixedAssetTabBar" recursive="includes-only"/>
    </menu>
    
    <menu name="FixedAssetTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="EditFixedAsset">
        <menu-item name="EditFixedAsset" title="${uiLabelMap.AccountingFixedAsset}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="EditFixedAsset">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="FixedAssetChildren" title="${uiLabelMap.CommonEntityChildren}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="FixedAssetChildren">
                <parameter param-name="fixedAssetId" />
                <parameter param-name="trail" from-field="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="ListFixedAssetProducts" title="${uiLabelMap.AccountingFixedAssetProducts}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="ListFixedAssetProducts">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="ListFixedAssetCalendar" title="${uiLabelMap.AccountingFixedAssetCalendar}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="calendar">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="EditFixedAssetStdCosts" title="${uiLabelMap.AccountingFixedAssetStdCosts}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="EditFixedAssetStdCosts">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="EditFixedAssetIdents" title="${uiLabelMap.AccountingFixedAssetIdents}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="EditFixedAssetIdents">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="EditFixedAssetRegistrations" title="${uiLabelMap.AccountingFixedAssetRegistrations}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="EditFixedAssetRegistrations">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <!-- SCIPIO: Makes navigation problematic; TODO: REVIEW
        <menu-item name="EditFixedAssetMeters" title="${uiLabelMap.AccountingFixedAssetMeters}">
            <link target="EditFixedAssetMeters">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>-->
        <menu-item name="ListFixedAssetMaints" title="${uiLabelMap.AccountingFixedAssetMaints}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="ListFixedAssetMaints">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <!-- SCIPIO: TODO: REVIEW: this request was removed from controller.xml, for reasons unknown to me
        <menu-item name="EditPartyFixedAssetAssignments" title="${uiLabelMap.AccountingPartyFixedAssetAssignments}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="EditPartyFixedAssetAssignments">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>-->
        <menu-item name="FixedAssetDepreciation" title="${uiLabelMap.AccountingDepreciation}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="showFixedAssetDepreciation">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
        <menu-item name="FixedAssetGeoLocation" title="${uiLabelMap.CommonGeoLocation}">
            <condition>
                <not>
                    <if-empty field="fixedAssetId"/>
                </not>
            </condition>
            <link target="FixedAssetGeoLocation">
                <parameter param-name="fixedAssetId" />
            </link>
        </menu-item>
    </menu>
    
    <!--
    ************** 
    * Invoices 
    **************
    -->
    <menu name="InvoiceSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="Invoices" title="${uiLabelMap.AccountingInvoices}">
            <link target="findInvoices" />
        </menu-item>
        <menu-item name="commissionRun" title="${uiLabelMap.AccountingCommissionRun}">
            <link target="CommissionRun"/>
        </menu-item>
        <menu-item name="commissionReport" title="${uiLabelMap.AccountingCommissionReport}">
            <link target="FindCommissions"/>
        </menu-item>
    </menu>
    
    <menu name="InvoiceSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="createNew" title="${uiLabelMap.AccountingCreateNewInvoice}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="newInvoice" />
        </menu-item>
        <menu-item name="copyInvoice" title="${uiLabelMap.CommonCopy}" widget-style="+${styles.action_run_sys} ${styles.action_copy}">
            <condition>
                <not>
                    <if-empty field="invoice.invoiceId" />
                </not>
            </condition>
            <link target="copyInvoice">
                <parameter param-name="invoiceIdToCopyFrom" from-field="invoiceId" />
            </link>
        </menu-item>
        <menu-item name="statusToApproved" title="${uiLabelMap.AccountingInvoiceStatusToApproved}" widget-style="+${styles.action_run_sys} ${styles.action_updatestatus}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_SENT" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_RECEIVED" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_APPROVED" />
            </link>
        </menu-item>
        <menu-item name="statusToReceived" title="${uiLabelMap.AccountingInvoiceStatusToReceived}" widget-style="+${styles.action_run_sys} ${styles.action_updatestatus}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                    <or>
                        <if-compare field="invoice.invoiceTypeId" operator="equals" value="PURCHASE_INVOICE" />
                        <if-compare field="invoice.invoiceTypeId" operator="equals" value="CUST_RTN_INVOICE" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_RECEIVED" />
            </link>
        </menu-item>
        <menu-item name="statusToSent" title="${uiLabelMap.AccountingInvoiceStatusToSent}" widget-style="+${styles.action_run_sys} ${styles.action_updatestatus}">
            <condition>
                <or>
                    <and>
                        <not>
                            <if-empty field="invoice.invoiceId" />
                        </not>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                        <if-compare field="invoice.invoiceTypeId" operator="equals" value="SALES_INVOICE" />
                    </and>
                    <and>
                        <not>
                            <if-empty field="invoice.invoiceId" />
                        </not>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_APPROVED" />
                        <if-compare field="invoice.invoiceTypeId" operator="equals" value="SALES_INVOICE" />
                    </and>
                </or>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_SENT" />
            </link>
        </menu-item>
        <menu-item name="statusToReady" title="${uiLabelMap.AccountingInvoiceStatusToReady}" widget-style="+${styles.action_run_sys} ${styles.action_updatestatus}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_SENT" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_RECEIVED" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_APPROVED" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_READY" />
            </link>
        </menu-item>
        <menu-item name="statusToPaid" title="${uiLabelMap.AccountingInvoiceStatusToPaid}" widget-style="+${styles.action_run_sys} ${styles.action_complete}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_READY" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_PAID" />
            </link>
        </menu-item>
        <menu-item name="statusToWriteoff" title="${uiLabelMap.AccountingInvoiceStatusToWriteoff}" widget-style="+${styles.action_run_sys} ${styles.action_terminate}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_READY" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus" request-confirmation="true"
                confirmation-message="You want to writeoff this invoice number ${invoice.invoiceId}?">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_WRITEOFF" />
            </link>
        </menu-item>
        <menu-item name="statusToInProcess" title="${uiLabelMap.AccountingInvoiceStatusToInProcess}" widget-style="+${styles.action_run_sys} ${styles.action_updatestatus}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_SENT" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_RECEIVED" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_IN_PROCESS" />
            </link>
        </menu-item>
        <menu-item name="statusToCancelled" title="${uiLabelMap.AccountingInvoiceStatusToCancelled}" widget-style="+${styles.action_run_sys} ${styles.action_terminate}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <or>
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_SENT" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_RECEIVED" />
                        <if-compare field="invoice.statusId" operator="equals" value="INVOICE_READY" />
                    </or>
                </and>
            </condition>
            <link target="setInvoiceStatus" request-confirmation="true" confirmation-message="${uiLabelMap.AccountingConfirmationCancelOrder}">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="statusId" value="INVOICE_CANCELLED" />
            </link>
        </menu-item>
        <menu-item name="addtax" title="${uiLabelMap.AccountingAddTax}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <if-compare field="invoice.statusId" operator="equals" value="INVOICE_IN_PROCESS" />
                </and>
            </condition>
            <link target="addtax">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
            </link>
        </menu-item>
        <menu-item name="pdf" title="${uiLabelMap.CommonPdf}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <not>
                    <if-empty field="invoice.invoiceId" />
                </not>
            </condition>
            <link target="invoice.pdf" target-window="_BLANK">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
            </link>
        </menu-item>
        <menu-item name="pdfDfltCur" title="${uiLabelMap.AccountingInvoicePDFDefaultCur} (${defaultOrganizationPartyCurrencyUomId})" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <and>
                    <not>
                        <if-empty field="invoice.invoiceId" />
                    </not>
                    <if-compare-field field="invoice.currencyUomId" operator="not-equals"
                        to-field="defaultOrganizationPartyCurrencyUomId" />
                </and>
            </condition>
            <link target="invoice.pdf" target-window="_BLANK">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
                <parameter param-name="currency" from-field="defaultOrganizationPartyCurrencyUomId" />
            </link>
        </menu-item>
        <menu-item name="sendPerEmail" title="${uiLabelMap.CommonPdf}: ${uiLabelMap.CommonSendPerEmail}" widget-style="+${styles.action_run_sys} ${styles.action_send}">
            <condition>
                <not>
                    <if-empty field="invoice.invoiceId" />
                </not>
            </condition>
            <link target="sendPerEmail" target-window="_blank">
                <parameter param-name="invoiceId" from-field="invoice.invoiceId" />
            </link>
        </menu-item>
    </menu>
    
    <!--
    ************** 
    * Import/Export 
    **************
    -->
    <menu name="ImportExportSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <!--
        <menu-item name="importExport" title="${uiLabelMap.CommonImportExport}" sort-mode="off">
            <link target="ImportExport" />
        </menu-item>-->
        <menu-item name="exportTransactions" title="${uiLabelMap.AccountingAcctgTrans}" sort-mode="off">
            <link target="ExportTransactions" />
        </menu-item>
        <menu-item name="importInvoice" title="${uiLabelMap.AccountingInvoice}" sort-mode="off">
            <link target="ImportExportInvoice" />
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Transactions 
    **************
    -->
    <menu name="TransactionsSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <actions>
            <!-- SCIPIO: DEV NOTE: This must NOT be set global or it may get shadowed by a null in the MapStack: global="true";
                global is usually not appropriate for menu actions -->
            <set field="organizationPartyId" from-field="parameters.organizationPartyId" default-value="${defaultOrganizationPartyId}"/>            
        </actions>
    </menu>

    <!-- 
    **************
    * Reports 
    **************
    -->
    <menu name="TransactionReportsSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="TransactionTotals" always-expand-selected-or-ancestor="true">
        <actions>
            <!-- SCIPIO: DEV NOTE: This must NOT be set global or it may get shadowed by a null in the MapStack: global="true";
                global is usually not appropriate for menu actions -->
            <set field="organizationPartyId" from-field="parameters.organizationPartyId" default-value="${defaultOrganizationPartyId}"/>
        </actions>
        <!--
        <menu-item name="journals" title="${uiLabelMap.AccountingGlJournals}" sort-mode="off">
            <link target="journals" />
        </menu-item>-->
        
<!--         <menu-item name="TransactionReports" title="${uiLabelMap.AccountingAcctgTrans}" sort-mode="off">
            <link target="TransactionReports" />
        </menu-item> -->
        <menu-item name="SalesInvoiceByProductCategorySummary" title="${uiLabelMap.PageTitleSalesInvoiceByProductCategorySummary}">
            <link target="SalesInvoiceByProductCategorySummary" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="TrialBalance" title="${uiLabelMap.AccountingTrialBalance}">
            <link target="TrialBalance" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="IncomeStatement" title="${uiLabelMap.AccountingIncomeStatement}">
            <link target="IncomeStatement" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="ComparativeIncomeStatement" title="${uiLabelMap.AccountingComparativeIncomeStatement}">
            <link target="ComparativeIncomeStatement" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="BalanceSheet" title="${uiLabelMap.AccountingBalanceSheet}">
            <link target="BalanceSheet">
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="ComparativeBalanceSheet" title="${uiLabelMap.AccountingComparativeBalanceSheet}">
            <link target="ComparativeBalanceSheet" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="TransactionTotals" title="${uiLabelMap.AccountingTransactionTotals}">
            <link target="TransactionTotals" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="InventoryValuation" title="${uiLabelMap.AccountingInventoryValuation}">
            <link target="InventoryValuation" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="CashFlowStatement" title="${uiLabelMap.AccountingCashFlowStatement}">
            <link target="CashFlowStatement" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        <menu-item name="ComparativeCashFlowStatement" title="${uiLabelMap.AccountingComparativeCashFlowStatement}">
            <link target="ComparativeCashFlowStatement" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        
        <!-- Previously unused screens -->
        <!-- Misses bsh information
        <menu-item name="FinancialSummaryReportOptions" title="${uiLabelMap.PageTitleFinancialSummaryReportOptions}">
            <link target="FinancialSummaryReportOptions" >
                <parameter param-name="organizationPartyId"/>
            </link>
        </menu-item>
        
         -->
        <!-- [component://accounting/webapp/accounting/WEB-INF/actions/reports/SalesInvoiceByProductGlAccountSummary.bsh
        <menu-item name="SalesInvoiceByProductGlAccountSummary" title="${uiLabelMap.PageTitleSalesInvoiceByProductGlAccountSummary}">
            <link target="SalesInvoiceByProductGlAccountSummary" />
        </menu-item>-->
        <!-- Misses component://accounting/webapp/accounting/WEB-INF/actions/reports/PaymentByMethodSummary.bsh
        <menu-item name="PaymentByMethodSummary" title="${uiLabelMap.PageTitlePaymentByMethodSummary}">
            <link target="PaymentByMethodSummary" />
        </menu-item>-->
        <!-- Misses component://accounting/webapp/accounting/WEB-INF/actions/reports/InventoryIssueSummary.bsh 
        <menu-item name="InventoryIssueSummary" title="${uiLabelMap.PageTitleInventoryIssueSummary}">
            <link target="InventoryIssueSummary" />
        </menu-item>-->
        <!-- Misses component://accounting/webapp/accounting/WEB-INF/actions/reports/FinancialAccountSummary.bsh
        <menu-item name="FinancialAccountSummary" title="${uiLabelMap.PageTitleFinancialAccountSummary}">
            <link target="FinancialAccountSummary" />
        </menu-item> -->
        <!-- Requires Organization
        <menu-item name="GlAccountTrialBalance" title="${uiLabelMap.AccountingGlAccountTrialBalance}"  sort-mode="off">
            <link target="GlAccountTrialBalance" />
        </menu-item> -->
    </menu>
    
    <menu name="OrganizationSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="addCompany" title="${uiLabelMap.AccountingNewCompany}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <if-compare field="hasPrefPermission" operator="equals" value="true" type="Boolean" />
            </condition>
            <link target="AddCompany" />
        </menu-item>
    </menu>
    
    <menu name="OrganizationTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        default-menu-item-name="PartyAccountsSummary">
        <menu-item name="PartyAccountsSummary" title="${uiLabelMap.AcctgPartyGlJournalSummary}" sort-mode="off">
            <link target="PartyAccountsSummary">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="AccountReconciliation" title="${uiLabelMap.AccountingAcctTransEntryRecon}">
            <link target="findGlAccountReconciliation">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="AccountReconciliations" title="${uiLabelMap.AccountingAcctGlRecon}">
            <link target="findGlAccountReconciliations">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="FindAcctgTrans" title="${uiLabelMap.AccountingAcctgTrans}">
            <link target="FindAcctgTrans">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="FindAcctgTransEntries" title="${uiLabelMap.AccountingAcctgTransEntries}">
            <link target="FindAcctgTransEntries">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="OrganizationAccountingReports" title="${uiLabelMap.AccountingTrialBalance}">
            <link target="TrialBalance">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="ChecksTabButton" title="${uiLabelMap.AccountingChecks}">
            <link target="listChecksToPrint">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
    </menu>    
    
    <menu name="PartyAccountingChecksTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        selected-menuitem-context-field-name="activeSubMenuItem2" default-menu-item-name="GlAccountSalInvoice">
        <menu-item name="PrintChecksTabButton" title="${uiLabelMap.AccountingPrintChecks}">
            <link target="listChecksToPrint">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="SendChecksTabButton" title="${uiLabelMap.AccountingSendChecks}">
            <link target="listChecksToSend">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Payments
    **************
     -->
     <menu name="PaymentTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="findPayments" title="${uiLabelMap.CommonFind} ${uiLabelMap.AccountingInvoicePayments}" sort-mode="off">
            <link target="findPayments" />
        </menu-item>

        <menu-item name="paymentOverview" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.AccountingPaymentTabOverview}">
            <condition>
                <not>
                    <if-empty field="payment.paymentId" />
                </not>
            </condition>
            <link target="paymentOverview">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
        <menu-item name="editPayment" title="${uiLabelMap.AccountingPayment}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <!-- SCIPIO: screen must handle this, if omitted here is confusing...
                    <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                    -->
                </and>
            </condition>
            <link target="editPayment">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
        <menu-item name="editPaymentApplications" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.AccountingPaymentTabApplications}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <or>
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_RECEIVED" />
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_SENT" />
                    </or>
                </and>
            </condition>
            <link target="editPaymentApplications">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
        <menu-item name="editPaymentApplications" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.AccountingPaymentTabApplications}">
        </menu-item>

        <menu-item name="authorizeTransaction" title="${uiLabelMap.AccountingAuthorize}">
            <link target="AuthorizeTransaction"/>
        </menu-item>
        <menu-item name="captureTransaction" title="${uiLabelMap.AccountingCapture}">
            <link target="CaptureTransaction"/>
        </menu-item>
        <menu-item name="gatewayResponses" title="${uiLabelMap.AccountingGatewayResponses}">
            <link target="FindGatewayResponses"/>
        </menu-item>
        <menu-item name="manualTransaction" title="${uiLabelMap.AccountingManualTransaction}">
            <link target="ManualTransaction"/>
        </menu-item>
    </menu>

    <menu name="PaymentSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml" menu-container-style="+scipio-nav-actions-menu">
        <include-elements menu-name="PaymentTabBar" recursive="includes-only" />
        <!-- <menu-item-alias name="findPayments" for="PARENT-WITHSUB"/>
        <menu-item-alias name="newPayment" for="PARENT-NOSUB"/> --> 
        <!-- <menu-item-alias name="newPayment" for="PARENT-WITHSUB"/> -->
    </menu>

    <menu name="PaymentSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <actions>
            <set field="isDisbursement" value="${groovy:if(context.payment != null) return org.ofbiz.accounting.util.UtilAccounting.isDisbursement(context.payment)}" />
        </actions>
        <menu-item name="createNew" title="${uiLabelMap.CommonNew} ${uiLabelMap.CommonPayment}" widget-style="+${styles.action_nav} ${styles.action_add}" >
            <condition>
                <not>
                    <if-empty field="payment.paymentId" />
                </not>
            </condition>
            <link target="newPayment" />
        </menu-item>
        <menu-item name="statusToSend" title="${uiLabelMap.AccountingPaymentTabStatusToSent}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <if-compare field="isDisbursement" operator="equals" value="true" />
                    <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                </and>
            </condition>
            <link target="setPaymentStatus">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
                <parameter param-name="statusId" value="PMNT_SENT" />
            </link>
        </menu-item>
        <menu-item name="statusToReceived" title="${uiLabelMap.AccountingPaymentTabStatusToReceived}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <if-compare field="isDisbursement" operator="equals" value="false" />
                    <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                </and>
            </condition>
            <link target="setPaymentStatus">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
                <parameter param-name="statusId" value="PMNT_RECEIVED" />
            </link>
        </menu-item>
        <menu-item name="statusToCancelled" title="${uiLabelMap.AccountingPaymentTabStatusToCancelled}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                </and>
            </condition>
            <link target="setPaymentStatus" request-confirmation="true" confirmation-message="You want to cancel this payment number ${payment.paymentId}?">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
                <parameter param-name="statusId" value="PMNT_CANCELLED" />
            </link>
        </menu-item>
        <menu-item name="statusToConfirmed" title="${uiLabelMap.AccountingPaymentTabStatusToConfirmed}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <or>
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_RECEIVED" />
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_SENT" />
                    </or>
                </and>
            </condition>
            <link target="setPaymentStatus">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
                <parameter param-name="statusId" value="PMNT_CONFIRMED" />
            </link>
        </menu-item>
        <menu-item name="printAsCheck" title="${uiLabelMap.AccountingPrintAsCheck}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <if-compare field="payment.statusId" operator="equals" value="PMNT_NOT_PAID" />
                </and>
            </condition>
            <link target="printChecks.pdf" target-window="_BLANK">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
        <menu-item name="statusToVoidPayment" title="${uiLabelMap.AccountingPaymentTabStatusToVoid}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <and>
                        <if-compare field="payment.statusId" operator="not-equals" value="PMNT_CONFIRMED" />
                        <if-compare field="payment.statusId" operator="not-equals" value="PMNT_VOID" />
                    </and>
                </and>
            </condition>
            <link target="voidPayment">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
        <!-- SCIPIO: FIXME: link target PaymentAcctgTransEntriesPdf does not exist...??
        <menu-item name="acctgTransEntriesPDF" title="${uiLabelMap.CommonPdf}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <and>
                    <not>
                        <if-empty field="payment.paymentId" />
                    </not>
                    <or>
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_RECEIVED" />
                        <if-compare field="payment.statusId" operator="equals" value="PMNT_SENT" />
                    </or>
                </and>
            </condition>
            <link target="PaymentAcctgTransEntriesPdf">
                <parameter param-name="paymentId" from-field="payment.paymentId" />
            </link>
        </menu-item>
          -->
    </menu>

    <!-- SCIPIO: new (NOTE THE PLURAL) -->
    <menu name="PaymentsSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="newPayment" title="${uiLabelMap.AccountingNewPayment}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="newPayment" />
        </menu-item>
        <menu-item name="FindSalesInvoicesByDueDate" title="${uiLabelMap.AccountingFindSalesInvoicesByDueDate}" widget-style="+${styles.action_nav} ${styles.action_find}">
            <link target="FindSalesInvoicesByDueDate" />
        </menu-item>
        <menu-item name="FindPurchaseInvoicesByDueDate" title="${uiLabelMap.AccountingFindPurchaseInvoicesByDueDate}" widget-style="+${styles.action_nav} ${styles.action_find}">
            <link target="FindPurchaseInvoicesByDueDate" />
        </menu-item>
    </menu>

    <menu name="PaymentGroupTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <!-- SCIPIO: redundant/problematic
        <menu-item name="findPayment" title="${uiLabelMap.CommonFind} ${uiLabelMap.AccountingPayment} ${uiLabelMap.CommonGroup}" sort-mode="off">
            <link target="FindPaymentGroup" />
        </menu-item>-->
        <menu-item name="PaymentGroupOverview" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.CommonGroup} ${uiLabelMap.AccountingPaymentTabOverview}">
            <condition>
                <not>
                    <if-empty field="paymentGroup.paymentGroupId" />
                </not>
            </condition>
            <link target="PaymentGroupOverview">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
        <menu-item name="EditPaymentGroup" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.CommonGroup}"><!--${uiLabelMap.CommonEdit} -->
            <condition>
                <not>
                    <if-empty field="paymentGroup.paymentGroupId" />
                </not>
            </condition>
            <link target="EditPaymentGroup">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
        <menu-item name="EditPaymentGroupMember" title="${uiLabelMap.AccountingPayment} ${uiLabelMap.AccountingGroupMembers}">
            <condition>
                <not>
                    <if-empty field="paymentGroup.paymentGroupId" />
                </not>
            </condition>
            <link target="EditPaymentGroupMember">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
    </menu>

    <menu name="PaymentGroupSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml" >
        <include-elements menu-name="PaymentGroupTabBar" recursive="includes-only" />
    </menu>

    <menu name="PaymentGroupSubTabBar" extends="CommonSubTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml"
        menu-container-style="+${styles.menu_buttonstyle_alt2}">
        <menu-item name="createNew" title="${uiLabelMap.AccountingCreateNewPaymentGroup}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditPaymentGroup" />
        </menu-item>
        <menu-item name="depositSlip" title="${uiLabelMap.AccountingDepositSlip}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <and>
                    <if-compare field="display" operator="equals" value="true" />
                    <if-compare field="paymentGroup.paymentGroupTypeId" operator="equals" value="BATCH_PAYMENT" />
                    <not>
                        <if-empty field="paymentGroupMembers" />
                    </not>
                </and>
            </condition>
            <link target="DepositSlip.pdf" target-window="_BLANK">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
        <menu-item name="printCheck" title="${uiLabelMap.AccountingPrintChecks}" widget-style="+${styles.action_run_sys} ${styles.action_export}">
            <condition>
                <and>
                    <if-compare field="display" operator="equals" value="true" />
                    <if-compare field="paymentGroup.paymentGroupTypeId" operator="equals" value="CHECK_RUN" />
                    <not>
                        <if-empty field="paymentGroupMembers" />
                    </not>
                </and>
            </condition>
            <link target="printChecks.pdf" target-window="_BLANK">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
        <menu-item name="cancelpaymentGroup" title="${uiLabelMap.AccountingCancelBatchPayments}">
            <condition>
                <and>
                    <not>
                        <if-empty field="paymentGroupMembers" />
                    </not>
                    <not>
                        <if-empty field="paymentGroup" />
                    </not>
                    <if-empty field="glReconciliationId" />
                    <if-compare field="paymentGroup.paymentGroupTypeId" operator="equals" value="BATCH_PAYMENT" />
                </and>
            </condition>
            <link target="cancelPaymentGroup">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
        <menu-item name="cancelCheckRunPayments" title="${uiLabelMap.AccountingCancelCheckRun}">
            <condition>
                <and>
                    <not>
                        <if-empty field="paymentGroupMembers" />
                    </not>
                    <not>
                        <if-empty field="paymentGroup" />
                    </not>
                    <if-compare field="paymentGroup.paymentGroupTypeId" operator="equals" value="CHECK_RUN" />
                </and>
            </condition>
            <link target="cancelCheckRunPayments">
                <parameter param-name="paymentGroupId" from-field="paymentGroup.paymentGroupId" />
            </link>
        </menu-item>
    </menu>
    
    <!-- 
    **************
    * Settings 
    **************-->
    <menu name="SettingsSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml" 
        default-menu-item-name="settings" always-expand-selected-or-ancestor="true">
        <actions>
            <!-- SCIPIO: DEV NOTE: This must NOT be set global or it may get shadowed by a null in the MapStack: global="true";
                global is usually not appropriate for menu actions -->
            <set field="organizationPartyId" from-field="parameters.organizationPartyId" default-value="${defaultOrganizationPartyId}"/>
        </actions>
        <menu-item name="settings" title="${uiLabelMap.AccountingCompanies}" sort-mode="off">
            <link target="settings" />
        </menu-item>
         <menu-item name="InvoiceItemTypes" title="${uiLabelMap.AccountingInvoiceItemType}">
            <link target="editInvoiceItemType" />
        </menu-item>
        <menu-item name="ViewRateAmounts" title="${uiLabelMap.AccountingRates}">
            <link target="viewRateAmounts" />
        </menu-item>
        <menu-item name="PaymentMethodTypes" title="${uiLabelMap.CommonPaymentMethodType}">
            <link target="editPaymentMethodType" />
        </menu-item>
        <menu-item name="ViewFXConversions" title="${uiLabelMap.AccountingFX}">
            <condition>
                <if-service-permission service-name="acctgFxPermissionCheck" main-action="UPDATE" />
            </condition>
            <link target="viewFXConversions">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="PaymentGatewayConfig" title="${uiLabelMap.AccountingPaymentGatewayConfig}">
            <condition>
                <or>
                    <if-has-permission permission="PAYPROC" action="_ADMIN"/>
                    <if-has-permission permission="ACCOUNTING" action="_ADMIN"/>
                </or>
            </condition>
            <link target="FindPaymentGatewayConfig"/>
            <sub-menu name="PaymentGatewayConfig" include="PaymentGatewayConfigSideBar"/>
        </menu-item>
        <menu-item name="Journals" title="${uiLabelMap.AccountingGlJournals}">
            <link target="journals">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="GlAccountAssignment" title="${uiLabelMap.AccountingGlAccountDefault}">
            <link target="GlAccountAssignment">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <menu-item name="FindGlAccountCategory" title="${uiLabelMap.FormFieldTitle_glAccountCategory}">
            <link target="FindGlAccountCategory" />
        </menu-item>
        <menu-item name="TaxAuthorities" title="${uiLabelMap.AccountingTaxAuthorities}">
            <link target="FindTaxAuthority" />
            <sub-menu name="TaxAuthority" include="TaxAuthoritySideBar"/>
        </menu-item>
        <menu-item name="findVendors" title="${uiLabelMap.AccountingVendors}">
            <link target="findVendors"/>
        </menu-item>
        <menu-item name="TimePeriods" title="${uiLabelMap.AccountingTimePeriods}">
            <link target="TimePeriods">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item>
        <!-- <menu-item name="CustomTimePeriods" title="${uiLabelMap.AccountingUpdateTimePeriod}">
            <link target="EditCustomTimePeriod">
                <parameter param-name="organizationPartyId" />
            </link>
        </menu-item> -->
    </menu>
    
    <!-- Payment Gateway -->
    <menu name="PaymentGatewayConfigSideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml" 
        default-menu-item-name="PaymentGatewayConfig" always-expand-selected-or-ancestor="true">
        <menu-item name="paymentGatewayConfigTab" title="${uiLabelMap.AccountingPaymentGatewayConfig}">
            <link target="FindPaymentGatewayConfig" />
        </menu-item>
        <menu-item name="paymentGatewayConfigTypesTab" title="${uiLabelMap.AccountingPaymentGatewayConfigTypes}">
            <link target="FindPaymentGatewayConfigTypes" />
        </menu-item>
    </menu>
    
    <menu name="TaxAuthorityTabBar" extends="CommonTabBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <!-- SCIPIO: don't use this, it just hides errors: default-menu-item-name="EditTaxAuthority" -->
        <menu-item-alias name="FindTaxAuthority" for="PARENT-NOSUB"/>
        <menu-item-alias name="NewTaxAuthority" for="PARENT-NOSUB"/>
        <menu-item-alias name="EditTaxAuthorityCategories" for="EditTaxAuthorityRateProducts"/>
        <menu-item-alias name="ListTaxAuthorityParties" for="EditTaxAuthority"/>
        <menu-item-alias name="EditTaxAuthorityPartyInfo" for="EditTaxAuthority"/>
        <menu-item-alias name="NewTaxAuthorityPartyInfo" for="EditTaxAuthority"/>
        <menu-item name="EditTaxAuthority" title="${uiLabelMap.AccountingTaxAuthority}">
            <link target="EditTaxAuthority">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
        <!-- SCIPIO: DEPRECATED (combined screens, aliased above)
        <menu-item name="EditTaxAuthorityCategories" title="${uiLabelMap.ProductCategories}">
            <link target="EditTaxAuthorityCategories">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>-->
        <menu-item name="EditTaxAuthorityAssocs" title="${uiLabelMap.CommonAssocs}">
            <link target="EditTaxAuthorityAssocs">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
        <menu-item name="EditTaxAuthorityGlAccounts" title="${uiLabelMap.AccountingGlAccs}">
            <link target="EditTaxAuthorityGlAccounts">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
        <menu-item name="EditTaxAuthorityRateProducts" title="${uiLabelMap.AccountingProductRates}">
            <link target="EditTaxAuthorityRateProducts">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
        <!-- SCIPIO: DEPRECATED (combined screens, aliased above)
        <menu-item name="ListTaxAuthorityParties" title="${uiLabelMap.PartyParties}">
            <link target="ListTaxAuthorityParties">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>-->
    </menu>
    <menu name="TaxAuthoritySideBar" extends="CommonSideBarMenu" extends-resource="component://common/widget/CommonMenus.xml" 
        always-expand-selected-or-ancestor="true" menu-container-style="+scipio-nav-actions-menu">
        <include-elements menu-name="TaxAuthorityTabBar" recursive="includes-only"/>
    </menu>

    <!-- SCIPIO: new -->
    <menu name="NewTaxAuthoritySubTabBar" extends="CommonButtonBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="EditTaxAuthority" title="${uiLabelMap.AccountingNewTaxAuthority}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditTaxAuthority" />
        </menu-item>
    </menu>

    <!-- SCIPIO: new -->
    <menu name="EditTaxAuthoritySubTabBar" extends="CommonButtonBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="EditTaxAuthority" title="${uiLabelMap.AccountingNewTaxAuthority}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="taxAuthority"/></not>
            </condition>
            <link target="EditTaxAuthority" />
        </menu-item>
    </menu>
    
    <!-- SCIPIO: new -->
    <menu name="ListTaxAuthorityPartiesSubTabBar" extends="CommonButtonBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="EditTaxAuthorityPartyInfo" title="${uiLabelMap.AccountingNewTaxAuthorityPartyInfo}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <link target="EditTaxAuthorityPartyInfo">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
    </menu>

    <!-- SCIPIO: new -->
    <menu name="EditTaxAuthorityPartyInfoSubTabBar" extends="CommonButtonBarMenu" extends-resource="component://common/widget/CommonMenus.xml">
        <menu-item name="EditTaxAuthority" title="${uiLabelMap.CommonBack}" widget-style="+${styles.action_nav} ${styles.action_cancel}">
            <link target="EditTaxAuthority" text="${uiLabelMap.CommonBack}" style="${styles.link_nav} ">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
        <menu-item name="EditTaxAuthorityPartyInfo" title="${uiLabelMap.AccountingNewTaxAuthorityPartyInfo}" widget-style="+${styles.action_nav} ${styles.action_add}">
            <condition>
                <not><if-empty field="partyTaxAuthInfo"/></not>
            </condition>
            <link target="EditTaxAuthorityPartyInfo">
                <parameter param-name="taxAuthPartyId"/>
                <parameter param-name="taxAuthGeoId"/>
            </link>
        </menu-item>
    </menu>
</menus>
