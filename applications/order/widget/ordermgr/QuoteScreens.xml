<?xml version="1.0" encoding="UTF-8"?>
<!--
This file is subject to the terms and conditions defined in the
files 'LICENSE' and 'NOTICE', which are part of this source
code package.
-->
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">
    
    <!-- list all assets in a tabular format -->
    <screen name="FindQuote">
        <section>
            <actions>
                <set field="titleProperty" value="OrderFindQuote"/>
                <set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <property-to-field resource="widget" property="widget.form.defaultViewSize" field="viewSizeDefaultValue"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="${viewSizeDefaultValue}"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <container>
                            <link target="EditQuote" text="${uiLabelMap.OrderNewQuote}" style="${styles.link_nav} ${styles.action_add}"/>
                        </container>
                        <screenlet>
                            <include-form name="FindQuotes" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                            <include-form name="ListQuotes" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="ViewQuote">
        <section>
            <actions>
                <set field="activeSubMenuItem" value="ViewQuote"/>
                
                <set field="showQuoteManagementLinks" value="Y"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                <get-related-one value-field="quote" relation-name="QuoteType" to-value-field="quoteType"/>
                <get-related-one value-field="quote" relation-name="StatusItem" to-value-field="statusItem"/>
                <get-related-one value-field="quote" relation-name="SalesChannelEnumeration" to-value-field="salesChannel"/>
                <get-related-one value-field="quote" relation-name="Uom" to-value-field="currency"/>
                <get-related-one value-field="quote" relation-name="ProductStore" to-value-field="store"/>
                
                
                <set field="listOrderBy[]" value="quoteItemSeqId"/>
                <get-related value-field="quote" relation-name="QuoteItem" list="quoteItems" order-by-list="listOrderBy"/>
                <get-related value-field="quote" relation-name="QuoteAdjustment" list="quoteAdjustments"/>
                <get-related value-field="quote" relation-name="QuoteRole" list="quoteRoles"/>
                <!--
                <get-related value-name="quote" relation-name="QuoteAttribute" list-name="quoteAttributes"/>
                <get-related value-name="quote" relation-name="QuoteCoefficient" list-name="quoteCoefficients"/>
                -->
                
                <set field="titleProperty" value="OrderQuote"/>
                <set field="titleFormat" value="\${finalTitle}: ${quoteId}"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="${uiLabelMap.CommonHeader}">
                            <include-form location="component://order/widget/ordermgr/QuoteForms.xml" name="QuoteHeader" />
                        </screenlet>
                        <include-screen name="ViewQuoteTemplate"/>
                        <screenlet title="${uiLabelMap.OrderCopyQuote}">
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/quote/CopyQuote.ftl"/></html>
                            </platform-specific>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ViewQuoteSimple">
        <section>
            <actions>
                <set field="showQuoteManagementLinks" value="N"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                <get-related-one value-field="quote" relation-name="QuoteType" to-value-field="quoteType"/>
                <get-related-one value-field="quote" relation-name="StatusItem" to-value-field="statusItem"/>
                <get-related-one value-field="quote" relation-name="Uom" to-value-field="currency"/>
                <get-related-one value-field="quote" relation-name="ProductStore" to-value-field="store"/>

                <get-related value-field="quote" relation-name="QuoteItem" list="quoteItems"/>
                <get-related value-field="quote" relation-name="QuoteAdjustment" list="quoteAdjustments"/>
                <get-related value-field="quote" relation-name="QuoteRole" list="quoteRoles"/>

                <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="AccountingUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
            </actions>
            <widgets>
                <include-screen name="ViewQuoteTemplate"/>
            </widgets>
        </section>
    </screen>
    
    <screen name="QuoteReport">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteReport"/>

                <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="AccountingUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                <get-related-one value-field="quote" relation-name="QuoteType" to-value-field="quoteType"/>
                <get-related-one value-field="quote" relation-name="StatusItem" to-value-field="statusItem"/>
                <get-related-one value-field="quote" relation-name="Uom" to-value-field="currency"/>
                <get-related-one value-field="quote" relation-name="ProductStore" to-value-field="store"/>
                <get-related-one value-field="quote" relation-name="Party" to-value-field="party"/>
                <get-related value-field="quote" relation-name="QuoteTerm" list="quoteTerms"/>
                
                <set field="listOrderBy[]" value="quoteItemSeqId"/>
                <get-related value-field="quote" relation-name="QuoteItem" list="quoteItems" order-by-list="listOrderBy"/>
                <get-related value-field="quote" relation-name="QuoteAdjustment" list="quoteAdjustments"/>

                <script location="component://order/webapp/ordermgr/WEB-INF/actions/quote/GetPartyAddress.groovy"/>
                <!--
                <get-related value-name="quote" relation-name="QuoteRole" list-name="quoteRoles"/>
                <get-related value-name="quote" relation-name="QuoteAttribute" list-name="quoteAttributes"/>
                <get-related value-name="quote" relation-name="QuoteCoefficient" list-name="quoteCoefficients"/>
                -->
            </actions>
            <widgets>
                <decorator-screen name="FoReportDecorator" location="component://common/widget/CommonScreens.xml">
                    <!-- at the top left of every page we put the logo and company information -->
                    <decorator-section name="topLeft">
                        <include-screen name="CompanyLogo" location="component://order/widget/ordermgr/OrderPrintScreens.xml"/>
                    </decorator-section>
                    <!-- at the top right of every page we put the order information -->
                    <decorator-section name="topRight">
                        <platform-specific>
                            <xsl-fo><html-template location="component://order/webapp/ordermgr/quote/quoteReportHeaderInfo.fo.ftl"/></xsl-fo>
                        </platform-specific>
                    </decorator-section>
                    <decorator-section name="body">
                        <!-- the contach mechanisms, terms, payment and shipping methods are shown in the first page -->
                        <platform-specific>
                            <xsl-fo><html-template location="component://order/webapp/ordermgr/quote/quoteReportContactMechs.fo.ftl"/></xsl-fo>
                        </platform-specific>
                        <!-- quote items and totals -->
                        <platform-specific>
                            <xsl-fo><html-template location="component://order/webapp/ordermgr/quote/quoteReportBody.fo.ftl"/></xsl-fo>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuote">
        <section>
            <actions>
                <set field="activeSubMenuItem" value="EditQuote"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                
                <set field="titleProperty" value="${groovy: context.quoteId ? 'OrderOrderQuote' : 'OrderNewQuote'}"/>
                <set field="titleFormat" value="\${finalTitle}${groovy: context.quoteId ? (': ' + context.quoteId) : ''}${groovy: context.quote?.quoteName ? (' - ' + context.quote.quoteName ) : ''}"/>
                
                <property-to-field field="defaultCurrencyUomId" resource="general" property="currency.uom.id.default" default="USD"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet><!-- title="${uiLabelMap.OrderOrderQuoteEdit}" -->
                            <include-form name="EditQuote" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListQuoteRoles">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteListRoles"/>
                <set field="activeSubMenuItem" value="ListQuoteRoles"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteRole" list="quoteRoles">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>

            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <include-form name="ListQuoteRoles" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditQuoteRole">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditRoles"/>
                <set field="activeSubMenuItem" value="ListQuoteRoles"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-one entity-name="QuoteRole" value-field="quoteRole"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteRole" text="${uiLabelMap.OrderCreateOrderQuoteRole}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="EditQuoteRole" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteItems">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteListItems"/>
                <set field="activeSubMenuItem" value="ListQuoteItems"/>

                <set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <property-to-field resource="widget" property="widget.form.defaultViewSize" field="viewSizeDefaultValue"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="${viewSizeDefaultValue}"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteItem" list="quoteItems">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                    <order-by field-name="quoteItemSeqId"/>
                </entity-and>

            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <include-form name="ListQuoteItems" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuoteItem">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditItems"/>
                <set field="activeSubMenuItem" value="ListQuoteItems"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-one entity-name="QuoteItem" value-field="quoteItem"/>
                <entity-and entity-name="QuoteTerm" list="quoteTerms">
                    <field-map field-name="quoteId"  from-field="parameters.quoteId"/>
                    <field-map field-name="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-form name="EditQuoteItem" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        <container style="${styles.grid_large}6">
                            <section>
                                <condition>
                                    <not><if-empty field="quoteItemSeqId"/></not>
                                </condition>
                                <widgets>
                                    <screenlet title="${uiLabelMap.OrderOrderQuoteTermList}">
                                        <include-form name="ListQuoteTermItem" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                                    </screenlet>
                                </widgets>
                            </section>
                        </container>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteAttributes">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteListAttributes"/>
                <set field="activeSubMenuItem" value="ListQuoteAttributes"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteAttribute" list="quoteAttributes">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteAttribute" text="${uiLabelMap.OrderCreateOrderQuoteAttribute}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="ListQuoteAttributes" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditQuoteAttribute">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditAttributes"/>
                <set field="activeSubMenuItem" value="ListQuoteAttributes"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="attrName" from-field="parameters.attrName"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-one entity-name="QuoteAttribute" value-field="quoteAttribute"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteAttribute" text="${uiLabelMap.OrderCreateOrderQuoteAttribute}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="EditQuoteAttribute" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteCoefficients">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteListCoefficients"/>
                <set field="activeSubMenuItem" value="ListQuoteCoefficients"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteCoefficient" list="quoteCoefficients">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteCoefficient" text="${uiLabelMap.OrderCreateOrderQuoteCoefficient}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="ListQuoteCoefficients" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditQuoteCoefficient">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditCoefficients"/>
                <set field="activeSubMenuItem" value="ListQuoteCoefficients"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="attrName" from-field="parameters.coeffName"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-one entity-name="QuoteCoefficient" value-field="quoteCoefficient"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteCoefficient" text="${uiLabelMap.OrderCreateOrderQuoteCoefficient}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="EditQuoteCoefficient" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ManageQuotePrices">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuotePrices"/>
                <set field="activeSubMenuItem" value="ManageQuotePrices"/>
                <set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <property-to-field resource="widget" property="widget.form.defaultViewSize" field="viewSizeDefaultValue"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="${viewSizeDefaultValue}"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteItem" list="quoteItems">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                    <order-by field-name="custRequestId"/>
                    <order-by field-name="custRequestItemSeqId"/>
                    <order-by field-name="quoteItemSeqId"/>
                </entity-and>
                <entity-and entity-name="QuoteCoefficient" list="quoteCoefficients">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>
                <set from-field="quote.quoteId" field="quoteId"/>

                <script location="component://order/webapp/ordermgr/WEB-INF/actions/quote/ManageQuotePrices.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="${uiLabelMap.OrderOrderQuotePrices}">
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/quote/ManageQuotePrices.ftl"/></html>
                            </platform-specific>
                        </screenlet>
                        <screenlet title="${uiLabelMap.OrderOrderQuotePrices}">
                            <include-form name="ManageQuotePrices" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/quote/ManageQuotePricesTotals.ftl"/></html>
                            </platform-specific>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListQuoteAdjustments">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteListAdjustments"/>
                <set field="activeSubMenuItem" value="ListQuoteAdjustments"/>
                <set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <property-to-field resource="widget" property="widget.form.defaultViewSize" field="viewSizeDefaultValue"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="${viewSizeDefaultValue}"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteAdjustment" list="quoteAdjustments">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="autoCreateQuoteAdjustments" text="${uiLabelMap.OrderRunStorePromotions}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId"/>
                                </link>
                                <link target="EditQuoteAdjustment" text="${uiLabelMap.OrderCreateOrderQuoteAdjustment}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="ListQuoteAdjustments" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuoteAdjustment">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditAdjustments"/>
                <set field="activeSubMenuItem" value="ListQuoteAdjustments"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="quoteAdjustmentId" from-field="parameters.quoteAdjustmentId"/>

                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-one entity-name="QuoteAdjustment" value-field="quoteAdjustment"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <container>
                                <link target="EditQuoteAdjustment" text="${uiLabelMap.OrderCreateOrderQuoteAdjustment}" style="${styles.link_nav} ${styles.action_add}">
                                    <parameter param-name="quoteId" from-field="quote.quoteId"/>
                                </link>
                            </container>
                            <include-form name="EditQuoteAdjustment" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ViewQuoteProfit">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteViewProfit"/>
                <set field="activeSubMenuItem" value="ViewQuoteProfit"/>
                <set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <property-to-field resource="widget" property="widget.form.defaultViewSize" field="viewSizeDefaultValue"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="${viewSizeDefaultValue}"/>
                
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteItem" list="quoteItems">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                    <order-by field-name="custRequestId"/>
                    <order-by field-name="custRequestItemSeqId"/>
                    <order-by field-name="quoteItemSeqId"/>
                </entity-and>
                <entity-and entity-name="QuoteCoefficient" list="quoteCoefficients">
                    <field-map field-name="quoteId" from-field="quote.quoteId"/>
                </entity-and>
                <set from-field="quote.quoteId" field="quoteId"/>
                
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/quote/ViewQuoteProfit.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/quote/ViewQuoteProfit.ftl"/></html>
                            </platform-specific>
                            <include-form name="ViewQuoteProfit" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuoteReportMail">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditReportMail"/>
                <set field="activeSubMenuItem" value="ViewQuote"/>

                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                <get-related-one value-field="quote" relation-name="Party" to-value-field="party"/>
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/quote/GetPartyEmailAddress.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <include-form name="EditQuoteReportMail" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="ViewQuoteTemplate">
        <section>
            <condition>
                <not><if-empty field="quote"/></not>
            </condition>
            <widgets>
                <label text="${note}"/>
                <include-screen name="ViewQuoteInfo"/>
                <container style="clear"/>
                <include-screen name="ViewQuoteItemInfo"/>
                <!-- SCIPIO (2019-02-20): I really don't understand what's the purpose of this. Likely to be removed, commenting out for now -->
                <!-- 
                <screenlet title="${uiLabelMap.CommonItems}">
                    <include-menu location="component://order/widget/ordermgr/OrderMenus.xml" name="QuoteItemsSubTabBar"/>
                </screenlet>
                -->
            </widgets>
            <fail-widgets>
                <label style="common-msg-error">${uiLabelMap.OrderNoQuoteFound}</label>
            </fail-widgets>
        </section>
    </screen>
    
    <screen name="ViewQuoteInfo">
        <section>
            <actions>
                <entity-and entity-name="QuoteTerm" list="quoteTerms">
                    <field-map field-name="quoteId"  from-field="parameters.quoteId"/>
                    <field-map field-name="quoteItemSeqId" value="_NA_"/>
                </entity-and>
                <entity-and entity-name="QuoteNoteView" list="quoteNotes">
                    <field-map field-name="quoteId"  from-field="parameters.quoteId"/>
                    <order-by field-name="-noteDateTime"/>
                </entity-and>
            </actions>
            <widgets>
                    <include-screen name="QuoteTermsInfo"/>
            </widgets>
        </section>
    </screen>
    
    <screen name="quoteInfo">
        <section>
            <widgets>
                <platform-specific>
                    <html><html-template location="component://order/webapp/ordermgr/quote/quoteInfo.ftl"/></html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteInfo">
        <section>
            <condition>
                <not><if-empty field="quoteTerms"/></not>
            </condition>
            <widgets>
                <screenlet title="${uiLabelMap.OrderOrderQuoteTermList}">
                    <include-form name="ListQuoteInfo" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                </screenlet>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteNoteInfo">
        <section>
            <condition>
                <not><if-empty field="quoteNotes"/></not>
            </condition>
            <widgets>
                <screenlet title="${uiLabelMap.OrderOrderQuoteNotes}">
                    <include-form name="ListQuoteNoteInfo" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                </screenlet>
            </widgets>
        </section>
    </screen>
    
    <screen name="quoteDate">
        <section>
            <widgets>
                <platform-specific>
                    <html><html-template location="component://order/webapp/ordermgr/quote/quoteDate.ftl"/></html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    
    <screen name="quoteRoles">
        <section>
            <widgets>
                <platform-specific>
                    <html><html-template location="component://order/webapp/ordermgr/quote/quoteRoles.ftl"/></html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    
    <screen name="ViewQuoteItemInfo">
        <section>
            <condition>
                <not><if-empty field="quoteItems"/></not>
            </condition>
            <actions>
                <entity-and entity-name="QuoteItem" list="quoteItemList">
                    <field-map field-name="quoteId" from-field="parameters.quoteId"/>
                </entity-and>
                <entity-one entity-name="Quote" value-field="quote">
                    <field-map field-name="quoteId" from-field="parameters.quoteId"/>
                </entity-one>
                <set field="quoteStatusId" from-field="quote.statusId"/>
            </actions>
            <widgets>
                <platform-specific>
                    <html><html-template location="component://order/webapp/ordermgr/quote/ViewQuoteItemInfo.ftl"/></html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuoteTerm">
        <section>
            <actions>
                <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="title" value="${uiLabelMap.OrderOrderQuoteEditTerm}"/>
                <set field="activeSubMenuItem" value="QuoteTerms"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="termTypeId" from-field="parameters.termTypeId"/>
                <set field="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>
                <entity-one entity-name="QuoteTerm" value-field="quoteTerm"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <set field="target" from-field="parameters.target"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <include-form name="EditQuoteTerm" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EditQuoteTermItem">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditTerm"/>
                <set field="activeSubMenuItem" value="ListQuoteItems"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="termTypeId" from-field="parameters.termTypeId"/>
                <set field="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>
                <entity-one entity-name="QuoteTerm" value-field="quoteTerm"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <set field="target" from-field="parameters.target"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet>
                            <include-form name="EditQuoteTermItem" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListQuoteTerms">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteEditTerm"/>
                <set field="activeSubMenuItem" value="QuoteTerms"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="termTypeId" from-field="parameters.termTypeId"/>
                <set field="quoteItemSeqId" from-field="parameters.quoteItemSeqId"/>
                <entity-one entity-name="QuoteTerm" value-field="quoteTerm"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteTerm" list="quoteTerms">
                    <field-map field-name="quoteId"  from-field="parameters.quoteId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="${uiLabelMap.OrderOrderQuoteTermList}">
                            <include-form name="ListQuoteTerms" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ListQuoteNotes">
        <section>
            <actions>
                <set field="titleProperty" value="OrderOrderQuoteNoteList"/>
                <set field="activeSubMenuItem" value="ListQuoteNotes"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="headerRowStyle" value="header-row-2"/>
                <entity-one entity-name="Quote" value-field="quote" auto-field-map="true"/>
                <entity-and entity-name="QuoteNoteView" list="quoteNotes">
                    <field-map field-name="quoteId"  from-field="parameters.quoteId"/>
                    <order-by field-name="-noteDateTime"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-form name="ListQuoteNotes" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="QuoteNewNote">
        <section>
            <condition>
                <not><if-empty field="parameters.quoteId"/></not>
            </condition>
            <actions>
                <set field="titleProperty" value="OrderAddNote"/>
                <set field="activeSubMenuItem" value="QuoteNotes"/>
                <set field="target" value="createquotenote"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-form name="AddOrEditQuoteNote" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
            <fail-widgets>
                <label style="common-msg-error-perm">${uiLabelMap.OrderViewPermissionError}</label>
            </fail-widgets>
        </section>
    </screen>
    <screen name="EditQuoteNote">
        <section>
            <condition>
                <and>
                    <not><if-empty field="parameters.noteId"/></not>
                    <not><if-empty field="parameters.quoteId"/></not>
                </and>
            </condition>
            <actions>
                <set field="titleProperty" value="QuoteEditNote"/>
                <set field="activeSubMenuItem" value="QuoteNotes"/>
                <set field="target" value="updateQuoteNote"/>
                <set field="quoteId" from-field="parameters.quoteId"/>
                <set field="noteId" from-field="parameters.noteId"/>
                <entity-one entity-name="Quote" value-field="quote"/>
                <entity-one entity-name="QuoteNoteView" value-field="quoteNoteData"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonQuoteDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-form name="AddOrEditQuoteNote" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
            <fail-widgets>
                <label style="common-msg-error-perm">${uiLabelMap.OrderViewPermissionError}</label>
            </fail-widgets>
        </section>
    </screen>

    <screen name="QuoteTermsInfo">
        <section>
            <condition>
                <not><if-empty field="quoteTerms"/></not>
            </condition>
            <widgets>
                <screenlet title="${uiLabelMap.CommonTerms}">
                    <include-form name="ListQuoteInfo" location="component://order/widget/ordermgr/QuoteForms.xml"/>
                </screenlet>
            </widgets>
        </section>
    </screen>
</screens>
